rules:
  - id: taint-rule
    languages:
      - javascript
      - typescript
    message: addServerSignature Usage Found
    mode: taint
 #   pattern-sanitizers:
 #     - pattern: none
    pattern-sinks:
 #     - pattern: addServerSignature
      - pattern: ctx.apiGatewayClient.addServerSignature(...)
      - pattern: ctx.apiGatewayClient.signWith(...)
      - pattern: client.get($VAR, ...)
      - pattern: req.$VAR
    pattern-sources:
      - patterns:
        - pattern-either:
            - pattern: $VAR = await addServerSignature(...);
    severity: ERROR
