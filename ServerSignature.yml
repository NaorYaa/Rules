rules:
  - id: taint-rule
    languages:
      - javascript
      - typescript
    message: addServerSignature Usage Found
    mode: taint
 #   pattern-sanitizers:
 #     - pattern: none
    pattern-sinks:
      - pattern: client.get($VAR, ...)
      - pattern: req
    pattern-sources:
      - patterns:
        - pattern-either:
            - pattern: $VAR = await addServerSignature(...);
            - pattern: addServerSignature
            - pattern: ctx.apiGatewayClient.addServerSignature(...)
            - pattern: ctx.apiGatewayClient.signWith(...)
    severity: ERROR
