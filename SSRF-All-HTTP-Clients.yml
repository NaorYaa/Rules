rules:
    - id: taint-rule
      languages:
        - js
      message: SSRF via serverless http.client
      mode: taint
      pattern-sanitizers:
        - patterns:
          - pattern-inside: $CLIENT.$METHOD('$URL', ...)
          - metavariable-regex:
              metavariable: $URL
              regex: \W*(http)\W*
        - patterns:
          - pattern-regex: ^.*getSquidProxyConfig.*$
      pattern-sinks:
        - pattern: fetch(...)
        - pattern: httpClient.$METHOD(...) 
        - pattern: http.$METHOD(...)
        - pattern: https.$METHOD(...)
        - pattern: got.$METHOD(...)
        - pattern: superagent.$METHOD(...)
        - pattern: axios.$METHOD(...)
      pattern-sources:
        - patterns:
          - pattern-either:
              - pattern: req
      severity: ERROR
